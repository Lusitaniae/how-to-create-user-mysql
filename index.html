
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>How to create Mysql user/grants</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="cover.css">
  <meta name="description" content="Simple copy paste tool to generate the Mysql queries required for creating users and managing permissions. Safe by default, limited permissions and good passwords. ">
  </head>

  <body class="text-center">

    <div class="cover-container d-flex h-100 p-3 mx-auto flex-column">
      <header class="masthead mb-auto">
        <div class="inner">
          <a href="/"><h1 class="masthead-brand">How to create Mysql user/grants</h1></a>

          <nav class="nav nav-masthead justify-content-center">
<!--             <a class="nav-link active" href="#">Home</a>
            <a class="nav-link" href="#">Features</a>
            <a class="nav-link" href="#">Contact</a> -->
          </nav>
        </div>
      </header>
<br>
      <main role="main" class="inner cover">
          <div class="row text-left">
            <!-- DB ENGINE -->
            <div class="col">
          <div class="custom-control custom-radio">
            <input type="radio" class="custom-control-input" checked>
            <label class="custom-control-label">Mysql/MariaDb</label>
          </div>
          <div class="custom-control custom-radio">
            <input type="radio" class="custom-control-input" disabled>
            <label class="custom-control-label">Postgres</label>
          </div>
          <div class="custom-control custom-radio">
            <input type="radio" class="custom-control-input" disabled>
            <label class="custom-control-label">Oracle</label>
          </div>
          <div class="custom-control custom-radio">
            <input type="radio" class="custom-control-input" disabled>
            <label class="custom-control-label">DB2</label>
          </div>
          <div class="custom-control custom-radio">
            <input type="radio" class="custom-control-input" disabled>
            <label class="custom-control-label">SQL Server</label>
          </div>
            </div>
            <!-- END DB ENGINE -->
            <!-- User/DB -->
            <div class="col">
            	<div class="input-group input-group-sm">
            		<input type="text" class="form-control" name="username" placeholder="username">
            	</div>
            	<div class="input-group input-group-sm">
            		<input type="text" class="form-control" name="database" placeholder="database">
            	</div>
              <div class="input-group input-group-sm">
                <input type="text" class="form-control" name="tables" value="*" placeholder="tables">
                <div class="input-group-append">
                   <button class="btn btn-primary any-tables" type="button">any</button>
                </div>

              </div>
            	<div class="input-group input-group-sm">
            		<input type="text" class="form-control" name="password" placeholder="password">
                <div class="input-group-append">
                   <button class="btn btn-primary password-new" type="button">new</button>
                </div>

            	</div>
            	<div class="input-group input-group-sm">
            		<input type="text" class="form-control" name="hostname" placeholder="hostname" value="localhost">
      					<div class="input-group-append">
                   <button class="btn btn-primary any-hostname" type="button">any</button>
      					</div>
            	</div>
            </div>
            <!-- User/DB -->
            <!-- Permissions -->
            <div class="col text-left">
				<div class="form-check align-items-left">
				  <input class="form-check-input"  name="perms" type="radio" value="ro" checked>
				  <label class="form-check-label">Read Only</label>
				</div>
				<div class="form-check">
				  <input class="form-check-input"  name="perms" type="radio" value="crud">
				  <label class="form-check-label">CRUD</label>
				</div>
				<div class="form-check disabled">
				  <input class="form-check-input" type="radio" name="perms" value="app">
				  <label class="form-check-label">Wordpress/App</label>
				</div>
				<div class="form-check disabled">
				  <input class="form-check-input" type="radio" name="perms" value="replication" disabled>
				  <label class="form-check-label">Replication</label>
				</div>
				<div class="form-check disabled">
				  <input class="form-check-input" type="radio" name="perms" value="admin">
				  <label class="form-check-label">Full Access/Admin</label>
				</div>
        </div>
            <!-- Permissions -->
          </div>
      <div class="md-form">
    <br>
        <textarea onfocus="this.select()" id="form7" class="md-textarea form-control" rows="3">
CREATE USER 'username'@'localhost' IDENTIFIED BY '******';
GRANT SELECT ON database.* TO 'username'@'localhost';</textarea>
      </div>
<br>
      <p> Generate your own secure password by pasting the snipet below in your shell:</p>
      <code> < /dev/urandom tr -dc _A-Z-a-z-0-9 | head -c${1:-32};echo;</code>
      <br>
      <br>
      <p>Manage your Mysql grants as code using <a href="ansible.html">Ansible</a> </p>
      <h3>About Mysql</h3>
      <p>Mysql is one of the most popular relational databases in the market. It's open source and free to use, popular Mysql alternatives like MariaDB, Percona, and Aurora Database from Amazon are all derived from Mysql and offer full (or very near) compatibility with the original Mysql.</p>
      <h3>Security/Other Concerns</h3>
      <p>The reason you want to create custom user/password and permission grants is 1) Security: you want restrict permissions of each application to the bare minimum, this will reduce blast radius of whatever problem you may face with exploits, 2) Monitoring: different users allows you to monitor database usage per application, impose limits, debug/troubleshoot problems, pinpoint the root cause earlier.</p>
      <h3>Mysql consulting</h3>
      <p>Looking for expert database admin consulting for your infrastructure? Founded by Peter Zaitsev, Percona is a database consulting company. They can provide support, advising or manage services for you. They maintain their own fork of Mysql, develop their own tools for live backups, Cluster management, and others. Active participants in the OSS community around Mysql and it's derivatives. Peter Zaitsev is the author of the most popular book about high performance Mysql and is a popular speaker at conferences. Percona employs over 100 database experts all over the world and can support any enterprise looking for improvements.</p>
      </main>

      <footer class="mastfoot mt-auto">
        <div class="inner">
          Copyright Â© 2020- howtocreateusermysql.com  All Rights Reserved.
        </div>
      </footer>
    </div>

    <style type="text/css">
    	.input-group { margin-bottom: 4px !important; }
      textarea { font-size: 12px!important; }
    </style>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="./files/password-generator.min.js" type="text/javascript"></script>
    <script type="text/javascript">

      $(document).ready(function() {
        updatePassword();
      });

    	let permissions = {
    		'ro': 			'SELECT',
    		'crud': 		'SELECT,UPDATE,INSERT,DELETE',
    		'app': 			'SELECT,UPDATE,INSERT,DELETE,CREATE,ALTER,INDEX,DROP',
    		'replication': 	'',
    		'admin': 		'ALL PRIVILEGES'
    	};

      function updatePassword() {
        let pass = generatePassword(32, false);
        $('input[name=password]').val(pass);
      }

    	function createUserQuery(user, host, pass) {
    		return `CREATE USER '${user}'@'${host}' IDENTIFIED BY '${pass}';`;
    	}

    	function createGrantsQuery(perms, db, tables, user, host) {
    		return `GRANT ${perms} ON ${db}.${tables} TO '${user}'@'${host}';`;
    	}

      $('.any-hostname').on('click', function(e) {
        $('input[name=hostname]').val('%');
        $('input').trigger("change");
      });

      $('.any-tables').on('click', function(e) {
        $('input[name=tables]').val('*');
        $('input').trigger("change");
      });

      $('.password-new').on('click', function(e) {
        updatePassword();
        $('input').trigger("change");
      });


    	$('input').on('change', function(e) {

	    	let user = $('input[name=username]').val().trim();
	    	let pass = $('input[name=password]').val().trim();
	    	let host = $('input[name=hostname]').val().trim();
	    	let db   = $('input[name=database]').val().trim();
	    	let tables = $('input[name=tables]').val().trim();
	    	let perms = permissions[$('input[name=perms]:checked').val()];
	    	let userQuery = createUserQuery(user, host, pass);
	    	let grantsQuery = createGrantsQuery(perms, db, tables, user, host);
	    	let result = [userQuery, grantsQuery].join('\n');
	    	$('textarea').val(result);

    	});

    </script>
  </body>
</html>
